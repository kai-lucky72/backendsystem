2025-08-04 08:09:51.443 +02:00 [INF] No migrations were found in assembly 'backend'. A migration needs to be added before the database can be updated.
2025-08-04 08:09:51.873 +02:00 [INF] Executed DbCommand (27ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-04 08:09:51.890 +02:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-08-04 08:09:51.960 +02:00 [INF] Executed DbCommand (67ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-08-04 08:09:52.177 +02:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-08-04 08:09:52.198 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-04 08:09:52.205 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-08-04 08:09:52.259 +02:00 [INF] Executed DbCommand (43ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-08-04 08:09:52.278 +02:00 [INF] No migrations were applied. The database is already up to date.
2025-08-04 08:09:52.293 +02:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-08-04 08:09:52.358 +02:00 [INF] User profile is available. Using 'C:\Users\Lamelo\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-04 08:09:52.479 +02:00 [INF] Now listening on: http://localhost:5238
2025-08-04 08:09:52.483 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-04 08:09:52.485 +02:00 [INF] Hosting environment: Development
2025-08-04 08:09:52.487 +02:00 [INF] Content root path: C:\Users\Lamelo\RiderProject\backend\backend
2025-08-04 08:10:29.684 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5238/swagger/index.html - null null
2025-08-04 08:10:29.786 +02:00 [WRN] Failed to determine the https port for redirect.
2025-08-04 08:10:30.036 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5238/swagger/index.html - 200 null text/html;charset=utf-8 358.144ms
2025-08-04 08:10:30.309 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5238/swagger/index.js - null null
2025-08-04 08:10:30.333 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5238/swagger/index.js - 200 null application/javascript;charset=utf-8 23.9368ms
2025-08-04 08:10:30.353 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5238/swagger/swagger-ui-standalone-preset.js - null null
2025-08-04 08:10:30.365 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5238/swagger/swagger-ui-bundle.js - null null
2025-08-04 08:10:30.395 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5238/swagger/index.js - null null
2025-08-04 08:10:30.400 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5238/swagger/index.js - 200 null application/javascript;charset=utf-8 5.2797ms
2025-08-04 08:10:30.452 +02:00 [INF] Sending file. Request path: '/swagger-ui-standalone-preset.js'. Physical path: 'N/A'
2025-08-04 08:10:30.464 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5238/swagger/swagger-ui-standalone-preset.js - 200 230007 text/javascript 111.0632ms
2025-08-04 08:10:30.473 +02:00 [INF] Sending file. Request path: '/swagger-ui-bundle.js'. Physical path: 'N/A'
2025-08-04 08:10:30.482 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5238/swagger/swagger-ui-bundle.js - 200 1426001 text/javascript 116.1816ms
2025-08-04 08:10:30.605 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5238/swagger/v1/swagger.json - null null
2025-08-04 08:10:31.033 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5238/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 428.1381ms
2025-08-04 09:33:10.862 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/auth/login - application/json 75
2025-08-04 09:33:10.949 +02:00 [INF] CORS policy execution successful.
2025-08-04 09:33:11.117 +02:00 [INF] Executing endpoint 'backend.Controllers.AuthController.LoginAlternativeRoute (backend)'
2025-08-04 09:33:11.213 +02:00 [INF] Route matched with {action = "LoginAlternativeRoute", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[backend.DTOs.Auth.AuthResponse]] LoginAlternativeRoute(backend.DTOs.Auth.AuthRequest) on controller backend.Controllers.AuthController (backend).
2025-08-04 09:33:11.324 +02:00 [INF] Executing action method backend.Controllers.AuthController.LoginAlternativeRoute (backend) - Validation state: "Valid"
2025-08-04 09:33:11.333 +02:00 [INF] LOGIN REQUEST RECEIVED - workId: ADM001, email: admin@example.com, role: ADMIN
2025-08-04 09:33:12.180 +02:00 [ERR] Failed executing DbCommand (69ms) [Parameters=[@__workId_0='?' (Size = 8)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccessFailedCount], [u].[Active], [u].[ConcurrencyStamp], [u].[created_at], [u].[Email], [u].[EmailConfirmed], [u].[first_name], [u].[last_login], [u].[last_name], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[national_id], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[password_hash], [u].[phone_number], [u].[PhoneNumberConfirmed], [u].[profile_image_url], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UserName], [u].[work_id], [a].[user_id], [a].[agent_type], [a].[group_id], [a].[manager_id], [a].[Sector], [m].[user_id], [m].[created_by], [m].[department]
FROM [users] AS [u]
LEFT JOIN [agents] AS [a] ON [u].[Id] = [a].[user_id]
LEFT JOIN [managers] AS [m] ON [u].[Id] = [m].[user_id]
WHERE [u].[work_id] = @__workId_0
2025-08-04 09:33:12.239 +02:00 [ERR] An exception occurred while iterating over the results of a query for context type 'backend.Data.ApplicationDbContext'.
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'AccessFailedCount'.
Invalid column name 'ConcurrencyStamp'.
Invalid column name 'EmailConfirmed'.
Invalid column name 'LockoutEnabled'.
Invalid column name 'LockoutEnd'.
Invalid column name 'NormalizedEmail'.
Invalid column name 'NormalizedUserName'.
Invalid column name 'PhoneNumberConfirmed'.
Invalid column name 'SecurityStamp'.
Invalid column name 'TwoFactorEnabled'.
Invalid column name 'UserName'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:17e48434-655e-4a42-a11a-53436e62caf7
Error Number:207,State:1,Class:16
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'AccessFailedCount'.
Invalid column name 'ConcurrencyStamp'.
Invalid column name 'EmailConfirmed'.
Invalid column name 'LockoutEnabled'.
Invalid column name 'LockoutEnd'.
Invalid column name 'NormalizedEmail'.
Invalid column name 'NormalizedUserName'.
Invalid column name 'PhoneNumberConfirmed'.
Invalid column name 'SecurityStamp'.
Invalid column name 'TwoFactorEnabled'.
Invalid column name 'UserName'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:17e48434-655e-4a42-a11a-53436e62caf7
Error Number:207,State:1,Class:16
2025-08-04 09:33:12.248 +02:00 [ERR] User not found with workId: ADM001
2025-08-04 09:33:12.259 +02:00 [INF] Executed action method backend.Controllers.AuthController.LoginAlternativeRoute (backend), returned result Microsoft.AspNetCore.Mvc.UnauthorizedResult in 924.4671ms.
2025-08-04 09:33:12.276 +02:00 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2025-08-04 09:33:12.323 +02:00 [INF] Executed action backend.Controllers.AuthController.LoginAlternativeRoute (backend) in 1102.718ms
2025-08-04 09:33:12.325 +02:00 [INF] Executed endpoint 'backend.Controllers.AuthController.LoginAlternativeRoute (backend)'
2025-08-04 09:33:12.337 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/auth/login - 401 null application/problem+json; charset=utf-8 1484.7645ms
2025-08-04 09:37:43.890 +02:00 [INF] Application is shutting down...
2025-08-04 09:51:45.728 +02:00 [INF] Executed DbCommand (65ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-04 09:51:45.905 +02:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-08-04 09:51:46.101 +02:00 [INF] Executed DbCommand (178ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-08-04 09:51:46.485 +02:00 [INF] Executed DbCommand (40ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-08-04 09:51:46.546 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-04 09:51:46.560 +02:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-08-04 09:51:46.669 +02:00 [INF] Executed DbCommand (89ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-08-04 09:51:46.728 +02:00 [INF] Applying migration '20250804073838_InitialCreate'.
2025-08-04 09:51:47.069 +02:00 [INF] Executed DbCommand (146ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetRoles] (
    [Id] bigint NOT NULL IDENTITY,
    [Name] nvarchar(256) NULL,
    [NormalizedName] nvarchar(256) NULL,
    [ConcurrencyStamp] nvarchar(max) NULL,
    CONSTRAINT [PK_AspNetRoles] PRIMARY KEY ([Id])
);
2025-08-04 09:51:47.195 +02:00 [ERR] Failed executing DbCommand (95ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [users] (
    [Id] bigint NOT NULL IDENTITY,
    [first_name] nvarchar(10) NOT NULL,
    [last_name] nvarchar(10) NOT NULL,
    [phone_number] nvarchar(15) NULL,
    [national_id] nvarchar(10) NULL,
    [Email] nvarchar(256) NOT NULL,
    [password_hash] nvarchar(10) NULL,
    [work_id] nvarchar(8) NOT NULL,
    [Role] int NOT NULL,
    [profile_image_url] nvarchar(10) NULL,
    [last_login] datetime2 NULL,
    [created_at] datetime2 NULL,
    [Active] bit NOT NULL,
    [UserName] nvarchar(256) NULL,
    [NormalizedUserName] nvarchar(256) NULL,
    [NormalizedEmail] nvarchar(256) NULL,
    [EmailConfirmed] bit NOT NULL,
    [SecurityStamp] nvarchar(max) NULL,
    [ConcurrencyStamp] nvarchar(max) NULL,
    [PhoneNumberConfirmed] bit NOT NULL,
    [TwoFactorEnabled] bit NOT NULL,
    [LockoutEnd] datetimeoffset NULL,
    [LockoutEnabled] bit NOT NULL,
    [AccessFailedCount] int NOT NULL,
    CONSTRAINT [PK_users] PRIMARY KEY ([Id])
);
2025-08-04 09:55:08.605 +02:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-04 09:55:08.666 +02:00 [INF] Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-08-04 09:55:08.678 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-08-04 10:27:32.700 +02:00 [INF] No migrations were found in assembly 'backend'. A migration needs to be added before the database can be updated.
2025-08-04 10:27:33.948 +02:00 [INF] Executed DbCommand (65ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-04 10:27:34.003 +02:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-08-04 10:27:34.155 +02:00 [INF] Executed DbCommand (144ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-08-04 10:27:34.581 +02:00 [INF] Executed DbCommand (37ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-08-04 10:27:34.627 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-04 10:27:34.642 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-08-04 10:27:34.744 +02:00 [INF] Executed DbCommand (87ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-08-04 10:27:34.780 +02:00 [INF] No migrations were applied. The database is already up to date.
2025-08-04 10:27:34.808 +02:00 [INF] Executed DbCommand (21ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-08-04 10:27:34.981 +02:00 [INF] User profile is available. Using 'C:\Users\Lamelo\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-04 10:27:35.245 +02:00 [INF] Now listening on: http://localhost:5238
2025-08-04 10:27:35.251 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-04 10:27:35.256 +02:00 [INF] Hosting environment: Development
2025-08-04 10:27:35.259 +02:00 [INF] Content root path: C:\Users\Lamelo\RiderProject\backend\backend
2025-08-04 10:27:47.116 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/auth/login - application/json 75
2025-08-04 10:27:47.157 +02:00 [WRN] Failed to determine the https port for redirect.
2025-08-04 10:27:47.163 +02:00 [INF] CORS policy execution successful.
2025-08-04 10:27:47.248 +02:00 [INF] Executing endpoint 'backend.Controllers.AuthController.LoginAlternativeRoute (backend)'
2025-08-04 10:27:47.278 +02:00 [INF] Route matched with {action = "LoginAlternativeRoute", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[backend.DTOs.Auth.AuthResponse]] LoginAlternativeRoute(backend.DTOs.Auth.AuthRequest) on controller backend.Controllers.AuthController (backend).
2025-08-04 10:27:47.350 +02:00 [INF] Executing action method backend.Controllers.AuthController.LoginAlternativeRoute (backend) - Validation state: "Valid"
2025-08-04 10:27:47.358 +02:00 [INF] LOGIN REQUEST RECEIVED - workId: ADM001, email: admin@example.com, role: ADMIN
2025-08-04 10:27:48.060 +02:00 [ERR] Failed executing DbCommand (76ms) [Parameters=[@__workId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccessFailedCount], [u].[Active], [u].[ConcurrencyStamp], [u].[created_at], [u].[Email], [u].[EmailConfirmed], [u].[first_name], [u].[last_login], [u].[last_name], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[national_id], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[password_hash], [u].[phone_number], [u].[PhoneNumberConfirmed], [u].[profile_image_url], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UserName], [u].[work_id], [a].[user_id], [a].[agent_type], [a].[group_id], [a].[manager_id], [a].[Sector], [m].[user_id], [m].[created_by], [m].[department]
FROM [users] AS [u]
LEFT JOIN [agents] AS [a] ON [u].[Id] = [a].[user_id]
LEFT JOIN [managers] AS [m] ON [u].[Id] = [m].[user_id]
WHERE [u].[work_id] = @__workId_0
2025-08-04 10:27:48.109 +02:00 [ERR] An exception occurred while iterating over the results of a query for context type 'backend.Data.ApplicationDbContext'.
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'AccessFailedCount'.
Invalid column name 'ConcurrencyStamp'.
Invalid column name 'EmailConfirmed'.
Invalid column name 'LockoutEnabled'.
Invalid column name 'LockoutEnd'.
Invalid column name 'NormalizedEmail'.
Invalid column name 'NormalizedUserName'.
Invalid column name 'PhoneNumberConfirmed'.
Invalid column name 'SecurityStamp'.
Invalid column name 'TwoFactorEnabled'.
Invalid column name 'UserName'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:f0af401a-ad72-4ce3-8da3-5bc752571709
Error Number:207,State:1,Class:16
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'AccessFailedCount'.
Invalid column name 'ConcurrencyStamp'.
Invalid column name 'EmailConfirmed'.
Invalid column name 'LockoutEnabled'.
Invalid column name 'LockoutEnd'.
Invalid column name 'NormalizedEmail'.
Invalid column name 'NormalizedUserName'.
Invalid column name 'PhoneNumberConfirmed'.
Invalid column name 'SecurityStamp'.
Invalid column name 'TwoFactorEnabled'.
Invalid column name 'UserName'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:f0af401a-ad72-4ce3-8da3-5bc752571709
Error Number:207,State:1,Class:16
2025-08-04 10:27:48.123 +02:00 [ERR] User not found with workId: ADM001
2025-08-04 10:27:48.133 +02:00 [INF] Executed action method backend.Controllers.AuthController.LoginAlternativeRoute (backend), returned result Microsoft.AspNetCore.Mvc.UnauthorizedResult in 773.9096ms.
2025-08-04 10:27:48.157 +02:00 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2025-08-04 10:27:48.218 +02:00 [INF] Executed action backend.Controllers.AuthController.LoginAlternativeRoute (backend) in 929.4207ms
2025-08-04 10:27:48.222 +02:00 [INF] Executed endpoint 'backend.Controllers.AuthController.LoginAlternativeRoute (backend)'
2025-08-04 10:27:48.242 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/auth/login - 401 null application/problem+json; charset=utf-8 1126.6489ms
2025-08-04 10:33:28.531 +02:00 [INF] Application is shutting down...
2025-08-04 11:34:01.940 +02:00 [INF] No migrations were found in assembly 'backend'. A migration needs to be added before the database can be updated.
2025-08-04 11:34:02.622 +02:00 [INF] Executed DbCommand (35ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-04 11:34:02.648 +02:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-08-04 11:34:02.753 +02:00 [INF] Executed DbCommand (96ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-08-04 11:34:02.986 +02:00 [INF] Executed DbCommand (34ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-08-04 11:34:03.019 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-04 11:34:03.031 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-08-04 11:34:03.112 +02:00 [INF] Executed DbCommand (73ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-08-04 11:34:03.135 +02:00 [INF] No migrations were applied. The database is already up to date.
2025-08-04 11:34:03.170 +02:00 [INF] Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-08-04 11:34:03.279 +02:00 [INF] User profile is available. Using 'C:\Users\Lamelo\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-04 11:34:03.496 +02:00 [INF] Now listening on: http://localhost:5238
2025-08-04 11:34:03.504 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-04 11:34:03.508 +02:00 [INF] Hosting environment: Development
2025-08-04 11:34:03.516 +02:00 [INF] Content root path: C:\Users\Lamelo\RiderProject\backend\backend
2025-08-04 11:34:19.907 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/auth/login - application/json 75
2025-08-04 11:34:20.006 +02:00 [WRN] Failed to determine the https port for redirect.
2025-08-04 11:34:20.017 +02:00 [INF] CORS policy execution successful.
2025-08-04 11:34:20.172 +02:00 [INF] Executing endpoint 'backend.Controllers.AuthController.LoginAlternativeRoute (backend)'
2025-08-04 11:34:20.249 +02:00 [INF] Route matched with {action = "LoginAlternativeRoute", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[backend.DTOs.Auth.AuthResponse]] LoginAlternativeRoute(backend.DTOs.Auth.AuthRequest) on controller backend.Controllers.AuthController (backend).
2025-08-04 11:34:20.423 +02:00 [INF] Executing action method backend.Controllers.AuthController.LoginAlternativeRoute (backend) - Validation state: "Valid"
2025-08-04 11:34:20.433 +02:00 [INF] LOGIN REQUEST RECEIVED - workId: ADM001, email: admin@example.com, role: ADMIN
2025-08-04 11:34:21.922 +02:00 [INF] Executed DbCommand (182ms) [Parameters=[@__workId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[active], [u].[created_at], [u].[email], [u].[first_name], [u].[last_login], [u].[last_name], [u].[national_id], [u].[password_hash], [u].[phone_number], [u].[profile_image_url], [u].[role], [u].[work_id], [a].[user_id], [a].[agent_type], [a].[group_id], [a].[manager_id], [a].[Sector], [m].[user_id], [m].[created_by], [m].[department]
FROM [users] AS [u]
LEFT JOIN [agents] AS [a] ON [u].[Id] = [a].[user_id]
LEFT JOIN [managers] AS [m] ON [u].[Id] = [m].[user_id]
WHERE [u].[work_id] = @__workId_0
2025-08-04 11:34:22.029 +02:00 [ERR] An exception occurred while iterating over the results of a query for context type 'backend.Data.ApplicationDbContext'.
System.InvalidCastException: Unable to cast object of type 'System.String' to type 'System.Int32'.
   at Microsoft.Data.SqlClient.SqlBuffer.get_Int32()
   at Microsoft.Data.SqlClient.SqlDataReader.GetInt32(Int32 i)
   at lambda_method69(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.InvalidCastException: Unable to cast object of type 'System.String' to type 'System.Int32'.
   at Microsoft.Data.SqlClient.SqlBuffer.get_Int32()
   at Microsoft.Data.SqlClient.SqlDataReader.GetInt32(Int32 i)
   at lambda_method69(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2025-08-04 11:34:22.114 +02:00 [ERR] User not found with workId: ADM001
2025-08-04 11:34:22.148 +02:00 [INF] Executed action method backend.Controllers.AuthController.LoginAlternativeRoute (backend), returned result Microsoft.AspNetCore.Mvc.UnauthorizedResult in 1698.0149ms.
2025-08-04 11:34:22.326 +02:00 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2025-08-04 11:34:22.781 +02:00 [INF] Executed action backend.Controllers.AuthController.LoginAlternativeRoute (backend) in 2470.6417ms
2025-08-04 11:34:22.878 +02:00 [INF] Executed endpoint 'backend.Controllers.AuthController.LoginAlternativeRoute (backend)'
2025-08-04 11:34:22.968 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/auth/login - 401 null application/problem+json; charset=utf-8 3064.7111ms
2025-08-04 11:48:57.539 +02:00 [INF] Application is shutting down...
2025-08-04 11:49:19.128 +02:00 [INF] No migrations were found in assembly 'backend'. A migration needs to be added before the database can be updated.
2025-08-04 11:49:20.382 +02:00 [INF] Executed DbCommand (138ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-04 11:49:20.440 +02:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-08-04 11:49:20.677 +02:00 [INF] Executed DbCommand (225ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-08-04 11:49:21.182 +02:00 [INF] Executed DbCommand (42ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-08-04 11:49:21.229 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-04 11:49:21.243 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-08-04 11:49:21.338 +02:00 [INF] Executed DbCommand (82ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-08-04 11:49:21.358 +02:00 [INF] No migrations were applied. The database is already up to date.
2025-08-04 11:49:21.408 +02:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-08-04 11:49:21.606 +02:00 [INF] User profile is available. Using 'C:\Users\Lamelo\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-04 11:49:22.182 +02:00 [INF] Now listening on: http://localhost:5238
2025-08-04 11:49:22.190 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-04 11:49:22.193 +02:00 [INF] Hosting environment: Development
2025-08-04 11:49:22.196 +02:00 [INF] Content root path: C:\Users\Lamelo\RiderProject\backend\backend
2025-08-04 11:49:31.669 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/auth/login - application/json 75
2025-08-04 11:49:31.750 +02:00 [WRN] Failed to determine the https port for redirect.
2025-08-04 11:49:31.759 +02:00 [INF] CORS policy execution successful.
2025-08-04 11:49:31.874 +02:00 [INF] Executing endpoint 'backend.Controllers.AuthController.LoginAlternativeRoute (backend)'
2025-08-04 11:49:31.995 +02:00 [INF] Route matched with {action = "LoginAlternativeRoute", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[backend.DTOs.Auth.AuthResponse]] LoginAlternativeRoute(backend.DTOs.Auth.AuthRequest) on controller backend.Controllers.AuthController (backend).
2025-08-04 11:49:32.179 +02:00 [INF] Executing action method backend.Controllers.AuthController.LoginAlternativeRoute (backend) - Validation state: "Valid"
2025-08-04 11:49:32.188 +02:00 [INF] LOGIN REQUEST RECEIVED - workId: ADM001, email: admin@example.com, role: ADMIN
2025-08-04 11:49:33.174 +02:00 [INF] Executed DbCommand (151ms) [Parameters=[@__workId_0='?' (Size = 50) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[active], [u].[created_at], [u].[email], [u].[first_name], [u].[last_login], [u].[last_name], [u].[national_id], [u].[password_hash], [u].[phone_number], [u].[profile_image_url], [u].[role], [u].[work_id]
FROM [users] AS [u]
WHERE [u].[work_id] = @__workId_0
2025-08-04 11:49:33.722 +02:00 [INF] Executed DbCommand (70ms) [Parameters=[@__p_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[user_id], [a].[agent_type], [a].[group_id], [a].[manager_id], [a].[Sector]
FROM [agents] AS [a]
WHERE [a].[user_id] = @__p_0
2025-08-04 11:49:33.760 +02:00 [INF] Executed DbCommand (12ms) [Parameters=[@__p_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[user_id], [m].[created_by], [m].[department]
FROM [managers] AS [m]
WHERE [m].[user_id] = @__p_0
2025-08-04 11:49:33.767 +02:00 [INF] Authentication successful for user: ADM001
2025-08-04 11:49:33.829 +02:00 [INF] Login successful for user: ADM001, returning token
2025-08-04 11:49:33.845 +02:00 [INF] Executed action method backend.Controllers.AuthController.LoginAlternativeRoute (backend), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 1653.6154ms.
2025-08-04 11:49:33.875 +02:00 [INF] Executing OkObjectResult, writing value of type 'backend.DTOs.Auth.AuthResponse'.
2025-08-04 11:49:33.910 +02:00 [INF] Executed action backend.Controllers.AuthController.LoginAlternativeRoute (backend) in 1900.8073ms
2025-08-04 11:49:33.915 +02:00 [INF] Executed endpoint 'backend.Controllers.AuthController.LoginAlternativeRoute (backend)'
2025-08-04 11:49:33.942 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/auth/login - 200 null application/json; charset=utf-8 2282.309ms
2025-08-04 11:54:56.329 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/auth/login - application/json 79
2025-08-04 11:54:56.372 +02:00 [INF] CORS policy execution successful.
2025-08-04 11:54:56.395 +02:00 [INF] Executing endpoint 'backend.Controllers.AuthController.LoginAlternativeRoute (backend)'
2025-08-04 11:54:56.407 +02:00 [INF] Route matched with {action = "LoginAlternativeRoute", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[backend.DTOs.Auth.AuthResponse]] LoginAlternativeRoute(backend.DTOs.Auth.AuthRequest) on controller backend.Controllers.AuthController (backend).
2025-08-04 11:54:56.454 +02:00 [INF] Executing action method backend.Controllers.AuthController.LoginAlternativeRoute (backend) - Validation state: "Valid"
2025-08-04 11:54:56.456 +02:00 [INF] LOGIN REQUEST RECEIVED - workId: MGR001, email: manager@company.com, role: MANAGER
2025-08-04 11:54:56.717 +02:00 [INF] Executed DbCommand (84ms) [Parameters=[@__workId_0='?' (Size = 50) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[active], [u].[created_at], [u].[email], [u].[first_name], [u].[last_login], [u].[last_name], [u].[national_id], [u].[password_hash], [u].[phone_number], [u].[profile_image_url], [u].[role], [u].[work_id]
FROM [users] AS [u]
WHERE [u].[work_id] = @__workId_0
2025-08-04 11:54:56.752 +02:00 [INF] Executed DbCommand (15ms) [Parameters=[@__p_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[user_id], [a].[agent_type], [a].[group_id], [a].[manager_id], [a].[Sector]
FROM [agents] AS [a]
WHERE [a].[user_id] = @__p_0
2025-08-04 11:54:56.767 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[user_id], [m].[created_by], [m].[department]
FROM [managers] AS [m]
WHERE [m].[user_id] = @__p_0
2025-08-04 11:54:56.836 +02:00 [INF] Authentication successful for user: MGR001
2025-08-04 11:54:56.847 +02:00 [INF] Login successful for user: MGR001, returning token
2025-08-04 11:54:56.849 +02:00 [INF] Executed action method backend.Controllers.AuthController.LoginAlternativeRoute (backend), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 392.887ms.
2025-08-04 11:54:56.852 +02:00 [INF] Executing OkObjectResult, writing value of type 'backend.DTOs.Auth.AuthResponse'.
2025-08-04 11:54:56.856 +02:00 [INF] Executed action backend.Controllers.AuthController.LoginAlternativeRoute (backend) in 443.7365ms
2025-08-04 11:54:56.861 +02:00 [INF] Executed endpoint 'backend.Controllers.AuthController.LoginAlternativeRoute (backend)'
2025-08-04 11:54:56.865 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/auth/login - 200 null application/json; charset=utf-8 542.5662ms
2025-08-04 11:56:38.749 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/auth/login - application/json 80
2025-08-04 11:56:38.754 +02:00 [INF] CORS policy execution successful.
2025-08-04 11:56:38.768 +02:00 [INF] Executing endpoint 'backend.Controllers.AuthController.LoginAlternativeRoute (backend)'
2025-08-04 11:56:38.770 +02:00 [INF] Route matched with {action = "LoginAlternativeRoute", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[backend.DTOs.Auth.AuthResponse]] LoginAlternativeRoute(backend.DTOs.Auth.AuthRequest) on controller backend.Controllers.AuthController (backend).
2025-08-04 11:56:38.791 +02:00 [INF] Executing action method backend.Controllers.AuthController.LoginAlternativeRoute (backend) - Validation state: "Valid"
2025-08-04 11:56:38.793 +02:00 [INF] LOGIN REQUEST RECEIVED - workId: AGT001, email: individual@company.com, role: AGENT
2025-08-04 11:56:38.815 +02:00 [INF] Executed DbCommand (17ms) [Parameters=[@__workId_0='?' (Size = 50) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[active], [u].[created_at], [u].[email], [u].[first_name], [u].[last_login], [u].[last_name], [u].[national_id], [u].[password_hash], [u].[phone_number], [u].[profile_image_url], [u].[role], [u].[work_id]
FROM [users] AS [u]
WHERE [u].[work_id] = @__workId_0
2025-08-04 11:56:38.828 +02:00 [INF] Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[user_id], [a].[agent_type], [a].[group_id], [a].[manager_id], [a].[Sector]
FROM [agents] AS [a]
WHERE [a].[user_id] = @__p_0
2025-08-04 11:56:38.837 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[user_id], [m].[created_by], [m].[department]
FROM [managers] AS [m]
WHERE [m].[user_id] = @__p_0
2025-08-04 11:56:38.842 +02:00 [INF] Authentication successful for user: AGT001
2025-08-04 11:56:39.501 +02:00 [INF] Executed DbCommand (411ms) [Parameters=[@__id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[user_id], [a].[agent_type], [a].[group_id], [a].[manager_id], [a].[Sector], [u].[Id], [u].[active], [u].[created_at], [u].[email], [u].[first_name], [u].[last_login], [u].[last_name], [u].[national_id], [u].[password_hash], [u].[phone_number], [u].[profile_image_url], [u].[role], [u].[work_id], [m].[user_id], [m].[created_by], [m].[department], [a0].[Id], [a0].[created_at], [a0].[description], [a0].[leader_id], [a0].[manager_id], [a0].[Name]
FROM [agents] AS [a]
INNER JOIN [users] AS [u] ON [a].[user_id] = [u].[Id]
INNER JOIN [managers] AS [m] ON [a].[manager_id] = [m].[user_id]
LEFT JOIN [agent_groups] AS [a0] ON [a].[group_id] = [a0].[Id]
WHERE [a].[user_id] = @__id_0
2025-08-04 11:56:39.516 +02:00 [WRN] Failed to get agent info for user AGT001: Agent not found with ID: 15
2025-08-04 11:56:39.518 +02:00 [INF] Login successful for user: AGT001, returning token
2025-08-04 11:56:39.520 +02:00 [INF] Executed action method backend.Controllers.AuthController.LoginAlternativeRoute (backend), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 726.507ms.
2025-08-04 11:56:39.526 +02:00 [INF] Executing OkObjectResult, writing value of type 'backend.DTOs.Auth.AuthResponse'.
2025-08-04 11:56:39.530 +02:00 [INF] Executed action backend.Controllers.AuthController.LoginAlternativeRoute (backend) in 754.4397ms
2025-08-04 11:56:39.535 +02:00 [INF] Executed endpoint 'backend.Controllers.AuthController.LoginAlternativeRoute (backend)'
2025-08-04 11:56:39.539 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/auth/login - 200 null application/json; charset=utf-8 789.0941ms
2025-08-04 11:57:27.665 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/auth/login - application/json 72
2025-08-04 11:57:27.670 +02:00 [INF] CORS policy execution successful.
2025-08-04 11:57:27.673 +02:00 [INF] Executing endpoint 'backend.Controllers.AuthController.LoginAlternativeRoute (backend)'
2025-08-04 11:57:27.678 +02:00 [INF] Route matched with {action = "LoginAlternativeRoute", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[backend.DTOs.Auth.AuthResponse]] LoginAlternativeRoute(backend.DTOs.Auth.AuthRequest) on controller backend.Controllers.AuthController (backend).
2025-08-04 11:57:27.682 +02:00 [INF] Executing action method backend.Controllers.AuthController.LoginAlternativeRoute (backend) - Validation state: "Valid"
2025-08-04 11:57:27.685 +02:00 [INF] LOGIN REQUEST RECEIVED - workId: AGT777, email: liam@prime.com, role: AGENT
2025-08-04 11:57:27.715 +02:00 [INF] Executed DbCommand (19ms) [Parameters=[@__workId_0='?' (Size = 50) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[active], [u].[created_at], [u].[email], [u].[first_name], [u].[last_login], [u].[last_name], [u].[national_id], [u].[password_hash], [u].[phone_number], [u].[profile_image_url], [u].[role], [u].[work_id]
FROM [users] AS [u]
WHERE [u].[work_id] = @__workId_0
2025-08-04 11:57:27.739 +02:00 [INF] Executed DbCommand (12ms) [Parameters=[@__p_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[user_id], [a].[agent_type], [a].[group_id], [a].[manager_id], [a].[Sector]
FROM [agents] AS [a]
WHERE [a].[user_id] = @__p_0
2025-08-04 11:57:27.792 +02:00 [INF] Executed DbCommand (13ms) [Parameters=[@__p_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[user_id], [m].[created_by], [m].[department]
FROM [managers] AS [m]
WHERE [m].[user_id] = @__p_0
2025-08-04 11:57:27.796 +02:00 [INF] Authentication successful for user: AGT777
2025-08-04 11:57:27.826 +02:00 [INF] Executed DbCommand (28ms) [Parameters=[@__id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[user_id], [a].[agent_type], [a].[group_id], [a].[manager_id], [a].[Sector], [u].[Id], [u].[active], [u].[created_at], [u].[email], [u].[first_name], [u].[last_login], [u].[last_name], [u].[national_id], [u].[password_hash], [u].[phone_number], [u].[profile_image_url], [u].[role], [u].[work_id], [m].[user_id], [m].[created_by], [m].[department], [a0].[Id], [a0].[created_at], [a0].[description], [a0].[leader_id], [a0].[manager_id], [a0].[Name]
FROM [agents] AS [a]
INNER JOIN [users] AS [u] ON [a].[user_id] = [u].[Id]
INNER JOIN [managers] AS [m] ON [a].[manager_id] = [m].[user_id]
LEFT JOIN [agent_groups] AS [a0] ON [a].[group_id] = [a0].[Id]
WHERE [a].[user_id] = @__id_0
2025-08-04 11:57:27.845 +02:00 [INF] Login successful for user: AGT777, returning token
2025-08-04 11:57:27.847 +02:00 [INF] Executed action method backend.Controllers.AuthController.LoginAlternativeRoute (backend), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 161.9858ms.
2025-08-04 11:57:27.850 +02:00 [INF] Executing OkObjectResult, writing value of type 'backend.DTOs.Auth.AuthResponse'.
2025-08-04 11:57:27.853 +02:00 [INF] Executed action backend.Controllers.AuthController.LoginAlternativeRoute (backend) in 172.5855ms
2025-08-04 11:57:27.857 +02:00 [INF] Executed endpoint 'backend.Controllers.AuthController.LoginAlternativeRoute (backend)'
2025-08-04 11:57:27.859 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/auth/login - 200 null application/json; charset=utf-8 193.6179ms
2025-08-04 11:59:23.658 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/auth/login - application/json 75
2025-08-04 11:59:23.664 +02:00 [INF] CORS policy execution successful.
2025-08-04 11:59:23.669 +02:00 [INF] Executing endpoint 'backend.Controllers.AuthController.LoginAlternativeRoute (backend)'
2025-08-04 11:59:23.680 +02:00 [INF] Route matched with {action = "LoginAlternativeRoute", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[backend.DTOs.Auth.AuthResponse]] LoginAlternativeRoute(backend.DTOs.Auth.AuthRequest) on controller backend.Controllers.AuthController (backend).
2025-08-04 11:59:23.691 +02:00 [INF] Executing action method backend.Controllers.AuthController.LoginAlternativeRoute (backend) - Validation state: "Valid"
2025-08-04 11:59:23.697 +02:00 [INF] LOGIN REQUEST RECEIVED - workId: AGT999, email: olivier@gmail.com, role: AGENT
2025-08-04 11:59:23.765 +02:00 [INF] Executed DbCommand (56ms) [Parameters=[@__workId_0='?' (Size = 50) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[active], [u].[created_at], [u].[email], [u].[first_name], [u].[last_login], [u].[last_name], [u].[national_id], [u].[password_hash], [u].[phone_number], [u].[profile_image_url], [u].[role], [u].[work_id]
FROM [users] AS [u]
WHERE [u].[work_id] = @__workId_0
2025-08-04 11:59:23.780 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[user_id], [a].[agent_type], [a].[group_id], [a].[manager_id], [a].[Sector]
FROM [agents] AS [a]
WHERE [a].[user_id] = @__p_0
2025-08-04 11:59:23.797 +02:00 [INF] Executed DbCommand (11ms) [Parameters=[@__p_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[user_id], [m].[created_by], [m].[department]
FROM [managers] AS [m]
WHERE [m].[user_id] = @__p_0
2025-08-04 11:59:23.801 +02:00 [INF] Authentication successful for user: AGT999
2025-08-04 11:59:23.818 +02:00 [INF] Executed DbCommand (11ms) [Parameters=[@__id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[user_id], [a].[agent_type], [a].[group_id], [a].[manager_id], [a].[Sector], [u].[Id], [u].[active], [u].[created_at], [u].[email], [u].[first_name], [u].[last_login], [u].[last_name], [u].[national_id], [u].[password_hash], [u].[phone_number], [u].[profile_image_url], [u].[role], [u].[work_id], [m].[user_id], [m].[created_by], [m].[department], [a0].[Id], [a0].[created_at], [a0].[description], [a0].[leader_id], [a0].[manager_id], [a0].[Name]
FROM [agents] AS [a]
INNER JOIN [users] AS [u] ON [a].[user_id] = [u].[Id]
INNER JOIN [managers] AS [m] ON [a].[manager_id] = [m].[user_id]
LEFT JOIN [agent_groups] AS [a0] ON [a].[group_id] = [a0].[Id]
WHERE [a].[user_id] = @__id_0
2025-08-04 11:59:23.823 +02:00 [INF] Login successful for user: AGT999, returning token
2025-08-04 11:59:23.825 +02:00 [INF] Executed action method backend.Controllers.AuthController.LoginAlternativeRoute (backend), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 128.0248ms.
2025-08-04 11:59:23.828 +02:00 [INF] Executing OkObjectResult, writing value of type 'backend.DTOs.Auth.AuthResponse'.
2025-08-04 11:59:23.831 +02:00 [INF] Executed action backend.Controllers.AuthController.LoginAlternativeRoute (backend) in 145.7985ms
2025-08-04 11:59:23.833 +02:00 [INF] Executed endpoint 'backend.Controllers.AuthController.LoginAlternativeRoute (backend)'
2025-08-04 11:59:23.835 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/auth/login - 200 null application/json; charset=utf-8 177.7747ms
2025-08-04 12:14:44.724 +02:00 [INF] Application is shutting down...
2025-08-04 12:15:04.109 +02:00 [INF] No migrations were found in assembly 'backend'. A migration needs to be added before the database can be updated.
2025-08-04 12:15:04.869 +02:00 [INF] Executed DbCommand (55ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-04 12:15:04.897 +02:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-08-04 12:15:05.037 +02:00 [INF] Executed DbCommand (134ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-08-04 12:15:05.360 +02:00 [INF] Executed DbCommand (27ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-08-04 12:15:05.391 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-04 12:15:05.401 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-08-04 12:15:05.506 +02:00 [INF] Executed DbCommand (95ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-08-04 12:15:05.519 +02:00 [INF] No migrations were applied. The database is already up to date.
2025-08-04 12:15:05.539 +02:00 [INF] Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-08-04 12:15:05.620 +02:00 [INF] User profile is available. Using 'C:\Users\Lamelo\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-04 12:15:05.748 +02:00 [INF] Now listening on: http://localhost:5238
2025-08-04 12:15:05.752 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-04 12:15:05.755 +02:00 [INF] Hosting environment: Development
2025-08-04 12:15:05.756 +02:00 [INF] Content root path: C:\Users\Lamelo\RiderProject\backend\backend
2025-08-04 12:15:19.781 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/auth/login - application/json 75
2025-08-04 12:15:19.813 +02:00 [WRN] Failed to determine the https port for redirect.
2025-08-04 12:15:19.820 +02:00 [INF] CORS policy execution successful.
2025-08-04 12:15:19.878 +02:00 [INF] Executing endpoint 'backend.Controllers.AuthController.LoginAlternativeRoute (backend)'
2025-08-04 12:15:19.902 +02:00 [INF] Route matched with {action = "LoginAlternativeRoute", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[backend.DTOs.Auth.AuthResponse]] LoginAlternativeRoute(backend.DTOs.Auth.AuthRequest) on controller backend.Controllers.AuthController (backend).
2025-08-04 12:15:19.962 +02:00 [INF] Executing action method backend.Controllers.AuthController.LoginAlternativeRoute (backend) - Validation state: "Valid"
2025-08-04 12:15:19.969 +02:00 [INF] LOGIN REQUEST RECEIVED - workId: AGT999, email: olivier@gmail.com, role: AGENT
2025-08-04 12:15:21.032 +02:00 [INF] Executed DbCommand (162ms) [Parameters=[@__workId_0='?' (Size = 50) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[active], [u].[created_at], [u].[email], [u].[first_name], [u].[last_login], [u].[last_name], [u].[national_id], [u].[password_hash], [u].[phone_number], [u].[profile_image_url], [u].[role], [u].[work_id]
FROM [users] AS [u]
WHERE [u].[work_id] = @__workId_0
2025-08-04 12:15:21.578 +02:00 [INF] Executed DbCommand (32ms) [Parameters=[@__p_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[user_id], [a].[agent_type], [a].[group_id], [a].[manager_id], [a].[Sector]
FROM [agents] AS [a]
WHERE [a].[user_id] = @__p_0
2025-08-04 12:15:21.700 +02:00 [INF] Executed DbCommand (15ms) [Parameters=[@__p_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[user_id], [m].[created_by], [m].[department]
FROM [managers] AS [m]
WHERE [m].[user_id] = @__p_0
2025-08-04 12:15:21.707 +02:00 [INF] Authentication successful for user: AGT999
2025-08-04 12:15:22.092 +02:00 [INF] Executed DbCommand (108ms) [Parameters=[@__id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[user_id], [a].[agent_type], [a].[group_id], [a].[manager_id], [a].[Sector], [u].[Id], [u].[active], [u].[created_at], [u].[email], [u].[first_name], [u].[last_login], [u].[last_name], [u].[national_id], [u].[password_hash], [u].[phone_number], [u].[profile_image_url], [u].[role], [u].[work_id], [m].[user_id], [m].[created_by], [m].[department], [a0].[Id], [a0].[created_at], [a0].[description], [a0].[leader_id], [a0].[manager_id], [a0].[Name]
FROM [agents] AS [a]
INNER JOIN [users] AS [u] ON [a].[user_id] = [u].[Id]
INNER JOIN [managers] AS [m] ON [a].[manager_id] = [m].[user_id]
LEFT JOIN [agent_groups] AS [a0] ON [a].[group_id] = [a0].[Id]
WHERE [a].[user_id] = @__id_0
2025-08-04 12:15:22.121 +02:00 [INF] Login successful for user: AGT999, returning token
2025-08-04 12:15:22.133 +02:00 [INF] Executed action method backend.Controllers.AuthController.LoginAlternativeRoute (backend), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 2161.8819ms.
2025-08-04 12:15:22.160 +02:00 [INF] Executing OkObjectResult, writing value of type 'backend.DTOs.Auth.AuthResponse'.
2025-08-04 12:15:22.205 +02:00 [INF] Executed action backend.Controllers.AuthController.LoginAlternativeRoute (backend) in 2288.0567ms
2025-08-04 12:15:22.209 +02:00 [INF] Executed endpoint 'backend.Controllers.AuthController.LoginAlternativeRoute (backend)'
2025-08-04 12:15:22.240 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/auth/login - 200 null application/json; charset=utf-8 2459.0844ms
2025-08-04 12:15:49.145 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/auth/login - application/json 79
2025-08-04 12:15:49.152 +02:00 [INF] CORS policy execution successful.
2025-08-04 12:15:49.169 +02:00 [INF] Executing endpoint 'backend.Controllers.AuthController.LoginAlternativeRoute (backend)'
2025-08-04 12:15:49.172 +02:00 [INF] Route matched with {action = "LoginAlternativeRoute", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[backend.DTOs.Auth.AuthResponse]] LoginAlternativeRoute(backend.DTOs.Auth.AuthRequest) on controller backend.Controllers.AuthController (backend).
2025-08-04 12:15:49.184 +02:00 [INF] Executing action method backend.Controllers.AuthController.LoginAlternativeRoute (backend) - Validation state: "Valid"
2025-08-04 12:15:49.185 +02:00 [INF] LOGIN REQUEST RECEIVED - workId: MGR001, email: manager@company.com, role: MANAGER
2025-08-04 12:15:49.264 +02:00 [INF] Executed DbCommand (24ms) [Parameters=[@__workId_0='?' (Size = 50) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[active], [u].[created_at], [u].[email], [u].[first_name], [u].[last_login], [u].[last_name], [u].[national_id], [u].[password_hash], [u].[phone_number], [u].[profile_image_url], [u].[role], [u].[work_id]
FROM [users] AS [u]
WHERE [u].[work_id] = @__workId_0
2025-08-04 12:15:49.271 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[user_id], [a].[agent_type], [a].[group_id], [a].[manager_id], [a].[Sector]
FROM [agents] AS [a]
WHERE [a].[user_id] = @__p_0
2025-08-04 12:15:49.279 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[user_id], [m].[created_by], [m].[department]
FROM [managers] AS [m]
WHERE [m].[user_id] = @__p_0
2025-08-04 12:15:49.283 +02:00 [ERR] Error retrieving user with workId: MGR001
System.InvalidOperationException: User with work ID MGR001 is deactivated
   at backend.Services.UserService.GetUserByWorkIdAsync(String workId) in C:\Users\Lamelo\RiderProject\backend\backend\Services\UserService.cs:line 125
2025-08-04 12:15:49.298 +02:00 [ERR] Database error while looking up user with workId: MGR001
System.InvalidOperationException: User with work ID MGR001 is deactivated
   at backend.Services.UserService.GetUserByWorkIdAsync(String workId) in C:\Users\Lamelo\RiderProject\backend\backend\Services\UserService.cs:line 125
   at backend.Controllers.AuthController.Login(AuthRequest request) in C:\Users\Lamelo\RiderProject\backend\backend\Controllers\AuthController.cs:line 59
2025-08-04 12:15:49.300 +02:00 [ERR] User not found with workId: MGR001
2025-08-04 12:15:49.301 +02:00 [INF] Executed action method backend.Controllers.AuthController.LoginAlternativeRoute (backend), returned result Microsoft.AspNetCore.Mvc.UnauthorizedResult in 116.6257ms.
2025-08-04 12:15:49.303 +02:00 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2025-08-04 12:15:49.328 +02:00 [INF] Executed action backend.Controllers.AuthController.LoginAlternativeRoute (backend) in 155.0234ms
2025-08-04 12:15:49.331 +02:00 [INF] Executed endpoint 'backend.Controllers.AuthController.LoginAlternativeRoute (backend)'
2025-08-04 12:15:49.332 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/auth/login - 401 null application/problem+json; charset=utf-8 187.2182ms
2025-08-04 14:09:38.562 +02:00 [INF] Application is shutting down...
2025-08-04 14:10:06.389 +02:00 [INF] No migrations were found in assembly 'backend'. A migration needs to be added before the database can be updated.
2025-08-04 14:10:08.300 +02:00 [INF] Executed DbCommand (72ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-04 14:10:08.440 +02:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-08-04 14:10:08.658 +02:00 [INF] Executed DbCommand (207ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-08-04 14:10:09.263 +02:00 [INF] Executed DbCommand (33ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-08-04 14:10:09.298 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-04 14:10:09.315 +02:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-08-04 14:10:09.408 +02:00 [INF] Executed DbCommand (81ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-08-04 14:10:09.433 +02:00 [INF] No migrations were applied. The database is already up to date.
2025-08-04 14:10:09.506 +02:00 [INF] Executed DbCommand (61ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-08-04 14:10:09.676 +02:00 [INF] User profile is available. Using 'C:\Users\Lamelo\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-04 14:10:09.973 +02:00 [INF] Now listening on: http://localhost:5238
2025-08-04 14:10:09.979 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-04 14:10:09.983 +02:00 [INF] Hosting environment: Development
2025-08-04 14:10:09.989 +02:00 [INF] Content root path: C:\Users\Lamelo\RiderProject\backend\backend
2025-08-04 14:11:58.559 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/auth/login - application/json 79
2025-08-04 14:11:58.694 +02:00 [WRN] Failed to determine the https port for redirect.
2025-08-04 14:11:58.704 +02:00 [INF] CORS policy execution successful.
2025-08-04 14:11:58.846 +02:00 [INF] Executing endpoint 'backend.Controllers.AuthController.LoginAlternativeRoute (backend)'
2025-08-04 14:11:58.908 +02:00 [INF] Route matched with {action = "LoginAlternativeRoute", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[backend.DTOs.Auth.AuthResponse]] LoginAlternativeRoute(backend.DTOs.Auth.AuthRequest) on controller backend.Controllers.AuthController (backend).
2025-08-04 14:11:59.042 +02:00 [INF] Executing action method backend.Controllers.AuthController.LoginAlternativeRoute (backend) - Validation state: "Valid"
2025-08-04 14:11:59.049 +02:00 [INF] LOGIN REQUEST RECEIVED - workId: MGR001, email: manager@company.com, role: MANAGER
2025-08-04 14:12:00.074 +02:00 [INF] Executed DbCommand (143ms) [Parameters=[@__workId_0='?' (Size = 50) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[active], [u].[created_at], [u].[email], [u].[first_name], [u].[last_login], [u].[last_name], [u].[national_id], [u].[password_hash], [u].[phone_number], [u].[profile_image_url], [u].[role], [u].[work_id]
FROM [users] AS [u]
WHERE [u].[work_id] = @__workId_0
2025-08-04 14:12:00.549 +02:00 [INF] Executed DbCommand (16ms) [Parameters=[@__p_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[user_id], [a].[agent_type], [a].[group_id], [a].[manager_id], [a].[Sector]
FROM [agents] AS [a]
WHERE [a].[user_id] = @__p_0
2025-08-04 14:12:00.588 +02:00 [INF] Executed DbCommand (12ms) [Parameters=[@__p_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[user_id], [m].[created_by], [m].[department]
FROM [managers] AS [m]
WHERE [m].[user_id] = @__p_0
2025-08-04 14:12:00.643 +02:00 [WRN] Login attempt for non-existent or inactive user with workId: MGR001
2025-08-04 14:12:00.658 +02:00 [INF] Executed action method backend.Controllers.AuthController.LoginAlternativeRoute (backend), returned result Microsoft.AspNetCore.Mvc.UnauthorizedObjectResult in 1606.0109ms.
2025-08-04 14:12:00.691 +02:00 [INF] Executing UnauthorizedObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-04 14:12:00.739 +02:00 [INF] Executed action backend.Controllers.AuthController.LoginAlternativeRoute (backend) in 1817.0026ms
2025-08-04 14:12:00.745 +02:00 [INF] Executed endpoint 'backend.Controllers.AuthController.LoginAlternativeRoute (backend)'
2025-08-04 14:12:00.771 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/auth/login - 401 null application/json; charset=utf-8 2225.2342ms
2025-08-04 14:12:36.081 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/auth/login - application/json 75
2025-08-04 14:12:36.096 +02:00 [INF] CORS policy execution successful.
2025-08-04 14:12:36.109 +02:00 [INF] Executing endpoint 'backend.Controllers.AuthController.LoginAlternativeRoute (backend)'
2025-08-04 14:12:36.111 +02:00 [INF] Route matched with {action = "LoginAlternativeRoute", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[backend.DTOs.Auth.AuthResponse]] LoginAlternativeRoute(backend.DTOs.Auth.AuthRequest) on controller backend.Controllers.AuthController (backend).
2025-08-04 14:12:36.124 +02:00 [INF] Executing action method backend.Controllers.AuthController.LoginAlternativeRoute (backend) - Validation state: "Valid"
2025-08-04 14:12:36.127 +02:00 [INF] LOGIN REQUEST RECEIVED - workId: ADM001, email: admin@example.com, role: ADMIN
2025-08-04 14:12:36.237 +02:00 [INF] Executed DbCommand (16ms) [Parameters=[@__workId_0='?' (Size = 50) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[active], [u].[created_at], [u].[email], [u].[first_name], [u].[last_login], [u].[last_name], [u].[national_id], [u].[password_hash], [u].[phone_number], [u].[profile_image_url], [u].[role], [u].[work_id]
FROM [users] AS [u]
WHERE [u].[work_id] = @__workId_0
2025-08-04 14:12:36.244 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[user_id], [a].[agent_type], [a].[group_id], [a].[manager_id], [a].[Sector]
FROM [agents] AS [a]
WHERE [a].[user_id] = @__p_0
2025-08-04 14:12:36.252 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[user_id], [m].[created_by], [m].[department]
FROM [managers] AS [m]
WHERE [m].[user_id] = @__p_0
2025-08-04 14:12:36.255 +02:00 [INF] Authentication successful for user: ADM001
2025-08-04 14:12:36.311 +02:00 [INF] Login successful for user: ADM001, returning token
2025-08-04 14:12:36.313 +02:00 [INF] Executed action method backend.Controllers.AuthController.LoginAlternativeRoute (backend), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 185.9434ms.
2025-08-04 14:12:36.318 +02:00 [INF] Executing OkObjectResult, writing value of type 'backend.DTOs.Auth.AuthResponse'.
2025-08-04 14:12:36.327 +02:00 [INF] Executed action backend.Controllers.AuthController.LoginAlternativeRoute (backend) in 212.4415ms
2025-08-04 14:12:36.330 +02:00 [INF] Executed endpoint 'backend.Controllers.AuthController.LoginAlternativeRoute (backend)'
2025-08-04 14:12:36.334 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/auth/login - 200 null application/json; charset=utf-8 251.9923ms
2025-08-04 14:29:55.569 +02:00 [INF] Application is shutting down...
2025-08-04 14:39:06.218 +02:00 [INF] No migrations were found in assembly 'backend'. A migration needs to be added before the database can be updated.
2025-08-04 14:39:07.062 +02:00 [INF] Executed DbCommand (31ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-04 14:39:07.099 +02:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-08-04 14:39:07.232 +02:00 [INF] Executed DbCommand (124ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-08-04 14:39:07.543 +02:00 [INF] Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-08-04 14:39:07.567 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-04 14:39:07.581 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-08-04 14:39:07.625 +02:00 [INF] Executed DbCommand (30ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-08-04 14:39:07.652 +02:00 [INF] No migrations were applied. The database is already up to date.
2025-08-04 14:39:07.678 +02:00 [INF] Executed DbCommand (20ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-08-04 14:39:07.812 +02:00 [INF] User profile is available. Using 'C:\Users\Lamelo\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-04 14:39:08.027 +02:00 [INF] Now listening on: http://localhost:5238
2025-08-04 14:39:08.034 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-04 14:39:08.037 +02:00 [INF] Hosting environment: Development
2025-08-04 14:39:08.040 +02:00 [INF] Content root path: C:\Users\Lamelo\RiderProject\backend\backend
2025-08-04 14:39:16.691 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5238/swagger/index.html - null null
2025-08-04 14:39:16.734 +02:00 [WRN] Failed to determine the https port for redirect.
2025-08-04 14:39:16.918 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5238/swagger/index.html - 200 null text/html;charset=utf-8 229.1646ms
2025-08-04 14:39:17.044 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5238/swagger/swagger-ui.css - null null
2025-08-04 14:39:17.062 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5238/swagger/index.css - null null
2025-08-04 14:39:17.065 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5238/swagger-ui/custom.css - null null
2025-08-04 14:39:17.066 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5238/swagger-ui/custom.js - null null
2025-08-04 14:39:17.067 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5238/swagger/swagger-ui-bundle.js - null null
2025-08-04 14:39:17.067 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5238/swagger/swagger-ui-standalone-preset.js - null null
2025-08-04 14:39:17.091 +02:00 [INF] Sending file. Request path: '/index.css'. Physical path: 'N/A'
2025-08-04 14:39:17.119 +02:00 [INF] Sending file. Request path: '/swagger-ui.css'. Physical path: 'N/A'
2025-08-04 14:39:17.128 +02:00 [INF] Sending file. Request path: '/swagger-ui-standalone-preset.js'. Physical path: 'N/A'
2025-08-04 14:39:17.131 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5238/swagger/index.css - 200 202 text/css 66.9341ms
2025-08-04 14:39:17.147 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5238/swagger/swagger-ui.css - 200 152035 text/css 103.6197ms
2025-08-04 14:39:17.147 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5238/swagger/swagger-ui-standalone-preset.js - 200 230007 text/javascript 79.8658ms
2025-08-04 14:39:17.153 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5238/swagger/index.js - null null
2025-08-04 14:39:17.166 +02:00 [INF] Sending file. Request path: '/swagger-ui-bundle.js'. Physical path: 'N/A'
2025-08-04 14:39:17.166 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5238/swagger/swagger-ui-standalone-preset.js - null null
2025-08-04 14:39:17.184 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5238/swagger/index.js - 200 null application/javascript;charset=utf-8 31.0563ms
2025-08-04 14:39:17.186 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5238/swagger/swagger-ui-bundle.js - 200 1426001 text/javascript 119.3419ms
2025-08-04 14:39:17.187 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5238/swagger/swagger-ui-bundle.js - null null
2025-08-04 14:39:17.193 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5238/swagger/index.js - null null
2025-08-04 14:39:17.195 +02:00 [INF] Sending file. Request path: '/swagger-ui-standalone-preset.js'. Physical path: 'N/A'
2025-08-04 14:39:17.225 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5238/swagger/index.js - 200 null application/javascript;charset=utf-8 31.6744ms
2025-08-04 14:39:17.226 +02:00 [INF] Sending file. Request path: '/swagger-ui-bundle.js'. Physical path: 'N/A'
2025-08-04 14:39:17.227 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5238/swagger/swagger-ui-standalone-preset.js - 200 230007 text/javascript 60.4782ms
2025-08-04 14:39:17.240 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5238/swagger/swagger-ui-bundle.js - 200 1426001 text/javascript 53.0791ms
2025-08-04 14:39:17.253 +02:00 [INF] Executing endpoint 'backend.Controllers.SwaggerController.GetCustomCss (backend)'
2025-08-04 14:39:17.253 +02:00 [INF] Executing endpoint 'backend.Controllers.SwaggerController.GetCustomJs (backend)'
2025-08-04 14:39:17.284 +02:00 [INF] Route matched with {action = "GetCustomJs", controller = "Swagger"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetCustomJs() on controller backend.Controllers.SwaggerController (backend).
2025-08-04 14:39:17.284 +02:00 [INF] Route matched with {action = "GetCustomCss", controller = "Swagger"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetCustomCss() on controller backend.Controllers.SwaggerController (backend).
2025-08-04 14:39:17.309 +02:00 [INF] Executing action method backend.Controllers.SwaggerController.GetCustomJs (backend) - Validation state: "Valid"
2025-08-04 14:39:17.309 +02:00 [INF] Executing action method backend.Controllers.SwaggerController.GetCustomCss (backend) - Validation state: "Valid"
2025-08-04 14:39:17.321 +02:00 [INF] Executed action method backend.Controllers.SwaggerController.GetCustomCss (backend), returned result Microsoft.AspNetCore.Mvc.ContentResult in 0.4649ms.
2025-08-04 14:39:17.321 +02:00 [INF] Executed action method backend.Controllers.SwaggerController.GetCustomJs (backend), returned result Microsoft.AspNetCore.Mvc.ContentResult in 0.6676ms.
2025-08-04 14:39:17.341 +02:00 [INF] Executing ContentResult with HTTP Response ContentType of application/javascript
2025-08-04 14:39:17.341 +02:00 [INF] Executing ContentResult with HTTP Response ContentType of text/css
2025-08-04 14:39:17.358 +02:00 [INF] Executed action backend.Controllers.SwaggerController.GetCustomJs (backend) in 61.3125ms
2025-08-04 14:39:17.358 +02:00 [INF] Executed action backend.Controllers.SwaggerController.GetCustomCss (backend) in 57.88ms
2025-08-04 14:39:17.364 +02:00 [INF] Executed endpoint 'backend.Controllers.SwaggerController.GetCustomJs (backend)'
2025-08-04 14:39:17.368 +02:00 [INF] Executed endpoint 'backend.Controllers.SwaggerController.GetCustomCss (backend)'
2025-08-04 14:39:17.369 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5238/swagger-ui/custom.js - 200 967 application/javascript 302.7299ms
2025-08-04 14:39:17.371 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5238/swagger-ui/custom.css - 200 1218 text/css 305.7264ms
2025-08-04 14:39:17.539 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5238/swagger/v1/swagger.json - null null
2025-08-04 14:39:17.626 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5238/swagger/favicon-32x32.png - null null
2025-08-04 14:39:17.635 +02:00 [INF] Sending file. Request path: '/favicon-32x32.png'. Physical path: 'N/A'
2025-08-04 14:39:17.638 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5238/swagger/favicon-32x32.png - 200 628 image/png 29.4393ms
2025-08-04 14:39:18.017 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5238/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 477.7053ms
2025-08-04 14:39:20.038 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5238/swagger-ui/custom.js - null null
2025-08-04 14:39:20.049 +02:00 [INF] Executing endpoint 'backend.Controllers.SwaggerController.GetCustomJs (backend)'
2025-08-04 14:39:20.051 +02:00 [INF] Route matched with {action = "GetCustomJs", controller = "Swagger"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetCustomJs() on controller backend.Controllers.SwaggerController (backend).
2025-08-04 14:39:20.053 +02:00 [INF] Executing action method backend.Controllers.SwaggerController.GetCustomJs (backend) - Validation state: "Valid"
2025-08-04 14:39:20.055 +02:00 [INF] Executed action method backend.Controllers.SwaggerController.GetCustomJs (backend), returned result Microsoft.AspNetCore.Mvc.ContentResult in 0.0409ms.
2025-08-04 14:39:20.057 +02:00 [INF] Executing ContentResult with HTTP Response ContentType of application/javascript
2025-08-04 14:39:20.059 +02:00 [INF] Executed action backend.Controllers.SwaggerController.GetCustomJs (backend) in 6.2246ms
2025-08-04 14:39:20.063 +02:00 [INF] Executed endpoint 'backend.Controllers.SwaggerController.GetCustomJs (backend)'
2025-08-04 14:39:20.066 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5238/swagger-ui/custom.js - 200 967 application/javascript 27.9667ms
2025-08-04 14:39:49.910 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/auth/login - application/json 75
2025-08-04 14:39:49.916 +02:00 [INF] CORS policy execution successful.
2025-08-04 14:39:49.923 +02:00 [INF] Executing endpoint 'backend.Controllers.AuthController.LoginAlternativeRoute (backend)'
2025-08-04 14:39:49.947 +02:00 [INF] Route matched with {action = "LoginAlternativeRoute", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[backend.DTOs.Auth.AuthResponse]] LoginAlternativeRoute(backend.DTOs.Auth.AuthRequest) on controller backend.Controllers.AuthController (backend).
2025-08-04 14:39:50.031 +02:00 [INF] Executing action method backend.Controllers.AuthController.LoginAlternativeRoute (backend) - Validation state: "Valid"
2025-08-04 14:39:50.041 +02:00 [INF] LOGIN REQUEST RECEIVED - workId: ADM001, email: admin@example.com, role: ADMIN
2025-08-04 14:39:50.968 +02:00 [INF] Executed DbCommand (117ms) [Parameters=[@__workId_0='?' (Size = 50) (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[active], [u].[created_at], [u].[email], [u].[first_name], [u].[last_login], [u].[last_name], [u].[national_id], [u].[password_hash], [u].[phone_number], [u].[profile_image_url], [u].[role], [u].[work_id]
FROM [users] AS [u]
WHERE [u].[work_id] = @__workId_0
2025-08-04 14:39:51.395 +02:00 [INF] Executed DbCommand (32ms) [Parameters=[@__p_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[user_id], [a].[agent_type], [a].[group_id], [a].[manager_id], [a].[Sector]
FROM [agents] AS [a]
WHERE [a].[user_id] = @__p_0
2025-08-04 14:39:51.443 +02:00 [INF] Executed DbCommand (11ms) [Parameters=[@__p_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[user_id], [m].[created_by], [m].[department]
FROM [managers] AS [m]
WHERE [m].[user_id] = @__p_0
2025-08-04 14:39:51.456 +02:00 [INF] Authentication successful for user: ADM001
2025-08-04 14:39:51.525 +02:00 [INF] Login successful for user: ADM001, returning token
2025-08-04 14:39:51.530 +02:00 [INF] Executed action method backend.Controllers.AuthController.LoginAlternativeRoute (backend), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 1496.1037ms.
2025-08-04 14:39:51.554 +02:00 [INF] Executing OkObjectResult, writing value of type 'backend.DTOs.Auth.AuthResponse'.
2025-08-04 14:39:51.583 +02:00 [INF] Executed action backend.Controllers.AuthController.LoginAlternativeRoute (backend) in 1630.9452ms
2025-08-04 14:39:51.588 +02:00 [INF] Executed endpoint 'backend.Controllers.AuthController.LoginAlternativeRoute (backend)'
2025-08-04 14:39:51.606 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/auth/login - 200 null application/json; charset=utf-8 1696.5349ms
